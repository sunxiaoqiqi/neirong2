# 文本解析功能使用文档

## 概述

文本解析功能允许用户通过编写结构化文本快速创建画布内容，包括设置画布尺寸、背景颜色以及添加各种图形元素。支持两种格式：简化格式和JSON格式。

## 支持的格式

### 1. 简化格式

简化格式使用缩进和冒号来定义属性，格式如下：

```
画布:
  宽度: 1080
  高度: 1440
背景:
  颜色: #ffffff
元素:
- 类型: 文本
  内容: 你好，世界！
  x: 100
  y: 100
  字号: 24
  颜色: #333333
```

### 2. JSON格式

也支持标准的JSON格式：

```json
{
  "canvas": {
    "宽度": 600,
    "高度": 400
  },
  "background": {
    "type": "solid",
    "color": "#ffffff"
  },
  "elements": [
    {
      "type": "text",
      "内容": "JSON格式也支持",
      "x": 100,
      "y": 100,
      "字号": 24,
      "颜色": "#333333"
    }
  ]
}
```

## 画布配置

画布配置定义整个画布的基本属性：

```
画布:
  宽度: [像素值]
  高度: [像素值]
```

**说明：**
- 宽度和高度以像素为单位
- 支持数值或带px后缀的字符串

## 背景配置

背景配置定义画布的背景颜色：

```
背景:
  颜色: [颜色值]
```

**说明：**
- 颜色值必须是有效的十六进制格式，如`#ffffff`

## 元素配置

### 1. 文本元素

**简化格式：**
```
- 类型: 文本
  内容: [文本内容]
  x: [x坐标]
  y: [y坐标]
  宽度: [可选，文本框宽度]
  高度: [可选，文本框高度]
  字号: [字号大小]
  颜色: [文本颜色]
  字重: [可选，normal或bold]
  字体: [可选，字体系列]
  对齐: [可选，left、center或right]
  字间距: [可选，字间距值]
  行间距: [可选，行间距值]
  角度: [可选，旋转角度]
```

**JSON格式：**
```json
{
  "type": "text",
  "内容": "文本内容",
  "x": 100,
  "y": 100,
  "宽度": 200,
  "高度": 50,
  "字号": 24,
  "颜色": "#000000",
  "字间距": 2,
  "行间距": 1.2,
  "角度": 45
}
```

**说明：** 宽度和高度用于定义文本框的尺寸，支持自动换行。未指定时将根据内容自动调整。字间距以像素为单位，行间距是相对于字体大小的倍数。

### 2. 矩形元素

**简化格式：**
```
- 类型: 矩形
  x: [x坐标]
  y: [y坐标]
  宽度: [宽度值]
  高度: [高度值]
  fill: [填充颜色]
  stroke: [边框颜色]
  边框宽度: [边框粗细]
  圆角: [可选，圆角半径]
  角度: [可选，旋转角度]
```

**JSON格式：**
```json
{
  "type": "rectangle",
  "x": 100,
  "y": 100,
  "宽度": 100,
  "高度": 100,
  "fill": "#ffffff",
  "stroke": "#000000",
  "边框宽度": 1,
  "角度": -30
}
```

**说明：** 也支持使用`rect`作为类型名称

### 3. 圆形元素

**简化格式：**
```
- 类型: 圆形
  x: [x坐标]
  y: [y坐标]
  半径: [半径值]
  fill: [填充颜色]
  stroke: [边框颜色]
  边框宽度: [边框粗细]
  角度: [可选，旋转角度]
```

**JSON格式：**
```json
{
  "type": "circle",
  "x": 100,
  "y": 100,
  "半径": 50,
  "fill": "#ffffff",
  "stroke": "#000000",
  "边框宽度": 1,
  "角度": 0
}
```

### 4. 线条元素

**简化格式：**
```
- 类型: 线条
  x: [x坐标]
  y: [y坐标]
  长度: [长度值]
  颜色: [线条颜色]
  线宽: [线条粗细]
  角度: [可选，旋转角度]
```

**JSON格式：**
```json
{
  "type": "line",
  "x": 100,
  "y": 100,
  "长度": 200,
  "颜色": "#000000",
  "线宽": 2,
  "角度": 90
}
```

### 5. 三角形元素

**简化格式：**
```
- 类型: 三角形
  x: [x坐标]
  y: [y坐标]
  宽度: [宽度值]
  高度: [高度值]
  fill: [填充颜色]
  stroke: [边框颜色]
  边框宽度: [边框粗细]
  角度: [可选，旋转角度]
```

**JSON格式：**
```json
{
  "type": "triangle",
  "x": 100,
  "y": 100,
  "宽度": 100,
  "高度": 100,
  "fill": "#ffffff",
  "stroke": "#000000",
  "边框宽度": 1,
  "角度": 120
}
```

### 6. Emoji元素

**简化格式：**
```
- 类型: emoji
  内容: [emoji字符]
  x: [x坐标]
  y: [y坐标]
  宽度: [可选，emoji容器宽度]
  高度: [可选，emoji容器高度]
  字号: [字号大小]
  颜色: [emoji颜色]
  对齐: [可选，left、center或right]
  字间距: [可选，字间距值]
  角度: [可选，旋转角度]
```

**JSON格式：**
```json
{
  "type": "emoji",
  "内容": "😊",
  "x": 100,
  "y": 100,
  "宽度": 60,
  "高度": 60,
  "字号": 48,
  "颜色": "#000000",
  "字间距": 5,
  "角度": 15
}
```

**说明：** 也支持使用`表情`作为类型名称。宽度和高度用于定义emoji容器的尺寸，未指定时将根据字号自动调整。字间距以像素为单位，用于调整多个emoji之间的距离。

## 通用属性说明

### 通用属性说明

### 文本尺寸说明
- 文本元素：通过宽度(width)和高度(height)定义文本框尺寸，支持自动换行
- Emoji元素：通过宽度(width)和高度(height)定义容器尺寸
- 未指定宽度和高度时，系统将根据内容和字号自动计算合适的尺寸

### 文本间距说明
- 字间距(letterSpacing)：以像素为单位，控制字符之间的间距，文本和emoji元素均支持
- 行间距(lineHeight)：相对于字体大小的倍数，控制行与行之间的间距，仅文本元素支持
- 未指定间距值时，字间距默认为0，行间距默认为1

### 坐标系统
- x: 元素左上角的x坐标
- y: 元素左上角的y坐标

### 角度说明
所有元素均支持角度设置，用于旋转元素：
- 角度单位：度（°）
- 支持的角度范围：-180° 到 180°
- 正值表示顺时针旋转，负值表示逆时针旋转
- 角度值将自动调整到有效范围内（例如：200° 将被转换为 -160°）
- 未指定角度值时，默认为0°（不旋转）

### 颜色值
- 颜色值必须是有效的十六进制格式，如`#000000`
- 支持常见颜色名称，如`red`、`blue`、`green`等

### 数值属性
- 数值属性可以是纯数字或带px后缀的字符串
- 未指定的数值属性将使用默认值

## 完整示例

### 示例1：包含多种元素的画布

```
画布:
  宽度: 800
  高度: 600
背景:
  颜色: #f0f0f0
元素:
- 类型: 文本
  内容: 文本解析示例
  x: 100
  y: 50
  字号: 36
  颜色: #333333
  对齐: center
  字间距: 3
  行间距: 1.2
  角度: 0
- 类型: 矩形
  x: 100
  y: 150
  宽度: 200
  高度: 100
  fill: #5475f5
  stroke: #333333
  边框宽度: 2
  角度: -15
- 类型: 圆形
  x: 500
  y: 200
  半径: 80
  fill: #ff7875
  stroke: #ff4d4f
  边框宽度: 1
  角度: 0
- 类型: emoji
  内容: 😊
  x: 400
  y: 350
  字号: 64
  角度: 15
- 类型: 线条
  x: 200
  y: 400
  长度: 400
  颜色: #1890ff
  线宽: 3
  角度: 45
- 类型: 三角形
  x: 350
  y: 450
  宽度: 120
  高度: 120
  fill: #73d13d
  stroke: #52c41a
  边框宽度: 2
  角度: 30
```

### 示例2：JSON格式完整配置

```json
{
  "canvas": {
    "宽度": 600,
    "高度": 400
  },
  "background": {
    "color": "#ffffff"
  },
  "elements": [
    {
      "type": "text",
      "内容": "JSON格式示例",
      "x": 50,
      "y": 50,
      "字号": 24,
      "颜色": "#333333",
      "字体": "Arial",
      "字间距": 2,
      "行间距": 1.1,
      "角度": 0
    },
    {
      "type": "rect",
      "x": 50,
      "y": 100,
      "宽度": 150,
      "高度": 100,
      "fill": "#e6f7ff",
      "stroke": "#1890ff",
      "边框宽度": 1,
      "圆角": 8,
      "角度": 5
    },
    {
      "type": "circle",
      "x": 350,
      "y": 150,
      "半径": 60,
      "fill": "#fff1f0",
      "stroke": "#ff4d4f",
      "角度": 0
    },
    {
      "type": "emoji",
      "内容": "👍",
      "x": 250,
      "y": 250,
      "字号": 48,
      "字间距": 3,
      "角度": -10
    },
    {
      "type": "line",
      "x": 400,
      "y": 280,
      "长度": 120,
      "颜色": "#52c41a",
      "线宽": 2,
      "角度": 30
    }
  ]
}
```

## 注意事项

1. 文本解析支持最多10000字符的输入
2. 所有坐标和尺寸均以像素为单位
3. 颜色值建议使用十六进制格式以获得最佳兼容性
4. 每个元素必须指定类型和坐标(x, y)
5. 文本元素必须包含内容属性
6. 注释可以使用#或//开头
7. 空行将被忽略

## 错误处理

如果解析过程中遇到错误，系统会显示具体的错误信息，包括：

- 无效的JSON格式
- 缺少必要属性
- 无效的颜色值
- 无效的坐标或尺寸

请根据错误提示修正您的文本内容。