# å†…å®¹ä¸­å° - æŠ€æœ¯æ¶æ„æ–¹æ¡ˆ

## ä¸€ã€æŠ€æœ¯é€‰å‹

### 1.1 å‰ç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
- **React 18+** + **TypeScript**
  - æˆç†Ÿç¨³å®šï¼Œç”Ÿæ€ä¸°å¯Œ
  - TypeScript æä¾›ç±»å‹å®‰å…¨
  - æ”¯æŒç»„ä»¶åŒ–å¼€å‘

#### UIæ¡†æ¶
- **Ant Design 5.x** æˆ– **Material-UI (MUI)**
  - ä¸°å¯Œçš„ç»„ä»¶åº“ï¼Œç¬¦åˆUIè§„èŒƒ
  - æ”¯æŒä¸»é¢˜å®šåˆ¶
  - å“åº”å¼è®¾è®¡

#### ç”»å¸ƒç¼–è¾‘å¼•æ“
- **Fabric.js 5.x** æˆ– **Konva.js**
  - Fabric.jsï¼šåŠŸèƒ½å¼ºå¤§ï¼Œé€‚åˆå¤æ‚ç”»å¸ƒæ“ä½œ
  - Konva.jsï¼šæ€§èƒ½ä¼˜ç§€ï¼Œ2Dæ¸²æŸ“å¼•æ“
  - æ”¯æŒå…ƒç´ æ‹–æ‹½ã€ç¼©æ”¾ã€æ—‹è½¬ç­‰æ“ä½œ

#### çŠ¶æ€ç®¡ç†
- **Zustand** æˆ– **Redux Toolkit**
  - Zustandï¼šè½»é‡çº§ï¼Œé€‚åˆä¸­å°å‹é¡¹ç›®
  - Redux Toolkitï¼šåŠŸèƒ½å¼ºå¤§ï¼Œé€‚åˆå¤æ‚çŠ¶æ€ç®¡ç†

#### è·¯ç”±ç®¡ç†
- **React Router 6.x**
  - å•é¡µåº”ç”¨è·¯ç”±ç®¡ç†

#### æ„å»ºå·¥å…·
- **Vite 5.x**
  - å¿«é€Ÿå¼€å‘æœåŠ¡å™¨
  - çƒ­æ¨¡å—æ›¿æ¢ï¼ˆHMRï¼‰
  - ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–æ‰“åŒ…

#### æ ·å¼æ–¹æ¡ˆ
- **Tailwind CSS 3.x**
  - åŸå­åŒ–CSSï¼Œå¿«é€Ÿå¼€å‘
  - ç¬¦åˆUIè§„èŒƒçš„é¢œè‰²ç³»ç»Ÿ
  - å“åº”å¼è®¾è®¡

#### HTTPå®¢æˆ·ç«¯
- **Axios**
  - è¯·æ±‚æ‹¦æˆªå™¨
  - å“åº”æ‹¦æˆªå™¨
  - é”™è¯¯å¤„ç†

### 1.2 åç«¯æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶ï¼ˆæ¨èæ–¹æ¡ˆä¸€ï¼šNode.jsï¼‰
- **Node.js 18+** + **TypeScript**
- **Express.js** æˆ– **Koa.js**
  - Expressï¼šæˆç†Ÿç¨³å®šï¼Œç”Ÿæ€ä¸°å¯Œ
  - Koaï¼šæ›´ç°ä»£ï¼Œä¸­é—´ä»¶æœºåˆ¶ä¼˜é›…

#### æ ¸å¿ƒæ¡†æ¶ï¼ˆæ¨èæ–¹æ¡ˆäºŒï¼šPythonï¼‰
- **Python 3.11+**
- **FastAPI**
  - é«˜æ€§èƒ½å¼‚æ­¥æ¡†æ¶
  - è‡ªåŠ¨APIæ–‡æ¡£ç”Ÿæˆ
  - ç±»å‹æç¤ºæ”¯æŒ

#### æ•°æ®åº“
- **SQLite**ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
  - é›¶é…ç½®ï¼Œå•æ–‡ä»¶æ•°æ®åº“
  - é€‚åˆæœ¬åœ°å¼€å‘
- **PostgreSQL**ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
  - åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢
  - æ”¯æŒJSONå­—æ®µå­˜å‚¨ç”»å¸ƒæ•°æ®

#### ORM/æ•°æ®åº“å·¥å…·
- **Prisma**ï¼ˆNode.jsï¼‰æˆ– **SQLAlchemy**ï¼ˆPythonï¼‰
  - ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®
  - è‡ªåŠ¨è¿ç§»
  - æŸ¥è¯¢æ„å»ºå™¨

#### æ–‡ä»¶å­˜å‚¨
- **æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ**ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- **MinIO**ï¼ˆç”Ÿäº§ç¯å¢ƒï¼Œå¯é€‰ï¼‰
  - S3å…¼å®¹çš„å¯¹è±¡å­˜å‚¨
  - æ”¯æŒå›¾ç‰‡ã€æ–‡ä»¶å­˜å‚¨

#### è®¤è¯æˆæƒ
- **JWT (JSON Web Token)**
  - æ— çŠ¶æ€è®¤è¯
  - ç®€å•æ˜“ç”¨

### 1.3 AIé›†æˆ

#### é€šä¹‰åƒé—®API
- **@alicloud/dashscope SDK**ï¼ˆNode.jsï¼‰
- **dashscope**ï¼ˆPythonï¼‰
- æ”¯æŒåŠŸèƒ½ï¼š
  - æ–‡æœ¬ç”Ÿæˆï¼ˆæ–‡æ¡ˆæ”¹å†™ï¼‰
  - å›¾åƒç”Ÿæˆï¼ˆAIç”Ÿå›¾ï¼‰

### 1.4 å¼€å‘å·¥å…·

#### ä»£ç è´¨é‡
- **ESLint** + **Prettier**ï¼ˆä»£ç æ ¼å¼åŒ–ï¼‰
- **Husky**ï¼ˆGit hooksï¼‰
- **TypeScript**ï¼ˆç±»å‹æ£€æŸ¥ï¼‰

#### ç‰ˆæœ¬æ§åˆ¶
- **Git**

#### å®¹å™¨åŒ–ï¼ˆå¯é€‰ï¼‰
- **Docker** + **Docker Compose**
  - ç»Ÿä¸€å¼€å‘ç¯å¢ƒ
  - æ˜“äºéƒ¨ç½²

---

## äºŒã€é¡¹ç›®ç»“æ„

```
å†…å®¹ä¸­å°/
â”œâ”€â”€ frontend/                    # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/          # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ common/          # åŸºç¡€ç»„ä»¶ï¼ˆButton, Inputç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/          # å¸ƒå±€ç»„ä»¶ï¼ˆHeader, Sidebarç­‰ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ canvas/           # ç”»å¸ƒç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/               # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Home/            # é¦–é¡µï¼ˆä½œå“å±•ç¤ºï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ Editor/           # ç¼–è¾‘å™¨é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Template/         # æ¨¡ç‰ˆé¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ Material/         # ç´ æé¡µé¢
â”‚   â”‚   â”œâ”€â”€ stores/              # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ editorStore.ts   # ç¼–è¾‘å™¨çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ canvasStore.ts   # ç”»å¸ƒçŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ userStore.ts     # ç”¨æˆ·çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ services/            # APIæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts           # APIé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ workService.ts   # ä½œå“ç›¸å…³API
â”‚   â”‚   â”‚   â”œâ”€â”€ templateService.ts # æ¨¡ç‰ˆç›¸å…³API
â”‚   â”‚   â”‚   â””â”€â”€ aiService.ts     # AIç›¸å…³API
â”‚   â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ canvasUtils.ts   # ç”»å¸ƒå·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ formatUtils.ts   # æ ¼å¼åŒ–å·¥å…·
â”‚   â”‚   â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ types/               # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ styles/              # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ globals.css      # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ App.tsx              # æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.tsx              # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ public/                  # é™æ€èµ„æº
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tailwind.config.js
â”‚
â”œâ”€â”€ backend/                     # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/         # æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ workController.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ templateController.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ materialController.ts
â”‚   â”‚   â”‚   â””â”€â”€ aiController.ts
â”‚   â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ workService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ templateService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ materialService.ts
â”‚   â”‚   â”‚   â””â”€â”€ aiService.ts     # AIæœåŠ¡ï¼ˆé€šä¹‰åƒé—®ï¼‰
â”‚   â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ Work.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ Template.ts
â”‚   â”‚   â”‚   â””â”€â”€ Material.ts
â”‚   â”‚   â”œâ”€â”€ routes/              # è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ workRoutes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ templateRoutes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ materialRoutes.ts
â”‚   â”‚   â”‚   â””â”€â”€ aiRoutes.ts
â”‚   â”‚   â”œâ”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts          # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ errorHandler.ts  # é”™è¯¯å¤„ç†
â”‚   â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ fileUtils.ts     # æ–‡ä»¶å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ logger.ts        # æ—¥å¿—å·¥å…·
â”‚   â”‚   â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ database.ts      # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ ai.ts            # AIé…ç½®ï¼ˆé€šä¹‰åƒé—®ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ storage.ts       # å­˜å‚¨é…ç½®
â”‚   â”‚   â”œâ”€â”€ app.ts               # Expressåº”ç”¨
â”‚   â”‚   â””â”€â”€ server.ts           # æœåŠ¡å™¨å…¥å£
â”‚   â”œâ”€â”€ prisma/                  # Prismaé…ç½®ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ schema.prisma
â”‚   â”‚   â””â”€â”€ migrations/
â”‚   â”œâ”€â”€ uploads/                 # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ images/             # å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ templates/           # æ¨¡ç‰ˆ
â”‚   â”‚   â””â”€â”€ materials/          # ç´ æ
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ .env.example
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â”œâ”€â”€ äº§å“éœ€æ±‚.md
â”‚   â”œâ”€â”€ UIè§„èŒƒ.md
â”‚   â””â”€â”€ APIæ–‡æ¡£.md
â”‚
â”œâ”€â”€ docker-compose.yml           # Docker Composeé…ç½®ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

---

## ä¸‰ã€æ•°æ®åº“è®¾è®¡

### 3.1 æ ¸å¿ƒè¡¨ç»“æ„

#### ä½œå“è¡¨ (works)
```sql
CREATE TABLE works (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(50) NOT NULL,
  description TEXT,
  canvas_data JSON,              -- ç”»å¸ƒæ•°æ®ï¼ˆFabric.jsæ ¼å¼ï¼‰
  thumbnail_url VARCHAR(255),     -- ç¼©ç•¥å›¾URL
  folder_id INTEGER,              -- æ–‡ä»¶å¤¹ID
  tags TEXT,                      -- æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰
  status VARCHAR(20) DEFAULT 'draft', -- draft, saved, published
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  user_id INTEGER
);
```

#### æ¨¡ç‰ˆè¡¨ (templates)
```sql
CREATE TABLE templates (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(50) NOT NULL,
  canvas_data JSON,               -- æ¨¡ç‰ˆç”»å¸ƒæ•°æ®
  thumbnail_url VARCHAR(255),
  tags TEXT,                      -- æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  user_id INTEGER
);
```

#### ç´ æè¡¨ (materials)
```sql
CREATE TABLE materials (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(100) NOT NULL,
  type VARCHAR(20) NOT NULL,      -- image, text, background, element
  file_url VARCHAR(255) NOT NULL,
  file_size INTEGER,              -- æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  folder_id INTEGER,
  tags TEXT,                      -- æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰
  metadata JSON,                   -- å…ƒæ•°æ®
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  user_id INTEGER
);
```

#### æ–‡ä»¶å¤¹è¡¨ (folders)
```sql
CREATE TABLE folders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(30) NOT NULL,
  parent_id INTEGER,               -- çˆ¶æ–‡ä»¶å¤¹IDï¼ˆæ”¯æŒåµŒå¥—ï¼‰
  type VARCHAR(20) NOT NULL,       -- work, template, material
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  user_id INTEGER
);
```

#### æ ‡ç­¾è¡¨ (tags)
```sql
CREATE TABLE tags (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(20) NOT NULL UNIQUE,
  color VARCHAR(7),               -- æ ‡ç­¾é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  user_id INTEGER
);
```

#### ç”¨æˆ·è¡¨ (users) - å¯é€‰
```sql
CREATE TABLE users (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  username VARCHAR(50) UNIQUE,
  email VARCHAR(100),
  password_hash VARCHAR(255),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

---

## å››ã€APIè®¾è®¡

### 4.1 ä½œå“ç›¸å…³API

```
GET    /api/works              # è·å–ä½œå“åˆ—è¡¨
POST   /api/works              # åˆ›å»ºä½œå“
GET    /api/works/:id          # è·å–ä½œå“è¯¦æƒ…
PUT    /api/works/:id          # æ›´æ–°ä½œå“
DELETE /api/works/:id          # åˆ é™¤ä½œå“
POST   /api/works/:id/duplicate # å¤åˆ¶ä½œå“
POST   /api/works/:id/export   # å¯¼å‡ºä½œå“
```

### 4.2 æ¨¡ç‰ˆç›¸å…³API

```
GET    /api/templates          # è·å–æ¨¡ç‰ˆåˆ—è¡¨
POST   /api/templates          # åˆ›å»ºæ¨¡ç‰ˆ
GET    /api/templates/:id      # è·å–æ¨¡ç‰ˆè¯¦æƒ…
PUT    /api/templates/:id      # æ›´æ–°æ¨¡ç‰ˆ
DELETE /api/templates/:id     # åˆ é™¤æ¨¡ç‰ˆ
POST   /api/templates/:id/apply # åº”ç”¨æ¨¡ç‰ˆåˆ°ä½œå“
```

### 4.3 ç´ æç›¸å…³API

```
GET    /api/materials          # è·å–ç´ æåˆ—è¡¨
POST   /api/materials          # ä¸Šä¼ ç´ æ
GET    /api/materials/:id      # è·å–ç´ æè¯¦æƒ…
PUT    /api/materials/:id      # æ›´æ–°ç´ æ
DELETE /api/materials/:id     # åˆ é™¤ç´ æ
POST   /api/materials/upload  # æ‰¹é‡ä¸Šä¼ 
```

### 4.4 AIç›¸å…³APIï¼ˆé€šä¹‰åƒé—®ï¼‰

```
POST   /api/ai/text-rewrite   # æ–‡æ¡ˆæ”¹å†™ï¼ˆå°çº¢ä¹¦æ–‡æ¡ˆæ”¹å†™ï¼‰
POST   /api/ai/image-generate # AIç”Ÿå›¾
```

### 4.5 æ–‡ä»¶å¤¹ç›¸å…³API

```
GET    /api/folders           # è·å–æ–‡ä»¶å¤¹æ ‘
POST   /api/folders           # åˆ›å»ºæ–‡ä»¶å¤¹
PUT    /api/folders/:id       # æ›´æ–°æ–‡ä»¶å¤¹
DELETE /api/folders/:id      # åˆ é™¤æ–‡ä»¶å¤¹
```

---

## äº”ã€é€šä¹‰åƒé—®APIé›†æˆ

### 5.1 å®‰è£…SDK

#### Node.js
```bash
npm install @alicloud/dashscope
```

#### Python
```bash
pip install dashscope
```

### 5.2 é…ç½®

åˆ›å»ºé…ç½®æ–‡ä»¶ `backend/src/config/ai.ts`:

```typescript
// Node.jsç‰ˆæœ¬
export const aiConfig = {
  apiKey: process.env.DASHSCOPE_API_KEY || '',
  baseURL: 'https://dashscope.aliyuncs.com/api/v1',
};

// Pythonç‰ˆæœ¬
# config/ai.py
import os
DASHSCOPE_API_KEY = os.getenv('DASHSCOPE_API_KEY', '')
```

### 5.3 æ–‡æ¡ˆæ”¹å†™æœåŠ¡

```typescript
// backend/src/services/aiService.ts (Node.js)
import { DashScope } from '@alicloud/dashscope';

export class AIService {
  private client: DashScope;

  constructor() {
    this.client = new DashScope({
      apiKey: process.env.DASHSCOPE_API_KEY || '',
    });
  }

  /**
   * å°çº¢ä¹¦æ–‡æ¡ˆæ”¹å†™
   */
  async rewriteText(originalText: string, prompt?: string): Promise<string> {
    const systemPrompt = prompt || 'è¯·å°†ä»¥ä¸‹æ–‡æ¡ˆæ”¹å†™æˆé€‚åˆå°çº¢ä¹¦å¹³å°çš„é£æ ¼ï¼Œè¦æ±‚ï¼š1. è¯­è¨€æ´»æ³¼æœ‰è¶£ 2. ä½¿ç”¨emojiè¡¨æƒ… 3. å¢åŠ äº’åŠ¨æ€§ 4. ä¿æŒåŸæ„';
    
    try {
      const response = await this.client.chat.completions.create({
        model: 'qwen-turbo', // æˆ– 'qwen-plus', 'qwen-max'
        messages: [
          { role: 'system', content: systemPrompt },
          { role: 'user', content: originalText },
        ],
        temperature: 0.7,
        max_tokens: 2000,
      });

      return response.choices[0].message.content || '';
    } catch (error) {
      console.error('æ–‡æ¡ˆæ”¹å†™å¤±è´¥:', error);
      throw new Error('æ–‡æ¡ˆæ”¹å†™å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
    }
  }

  /**
   * AIç”Ÿå›¾
   */
  async generateImage(prompt: string): Promise<string> {
    try {
      const response = await this.client.images.generations.create({
        model: 'wanx-v1', // é€šä¹‰ä¸‡ç›¸
        prompt: prompt,
        size: '1024x1024',
        n: 1,
      });

      return response.data[0].url || '';
    } catch (error) {
      console.error('AIç”Ÿå›¾å¤±è´¥:', error);
      throw new Error('AIç”Ÿå›¾å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
    }
  }
}
```

### 5.3.1 Pythonç‰ˆæœ¬

```python
# backend/src/services/ai_service.py
import dashscope
from dashscope import Generation, ImageSynthesis

class AIService:
    def __init__(self):
        dashscope.api_key = os.getenv('DASHSCOPE_API_KEY', '')
    
    def rewrite_text(self, original_text: str, prompt: str = None) -> str:
        """å°çº¢ä¹¦æ–‡æ¡ˆæ”¹å†™"""
        system_prompt = prompt or 'è¯·å°†ä»¥ä¸‹æ–‡æ¡ˆæ”¹å†™æˆé€‚åˆå°çº¢ä¹¦å¹³å°çš„é£æ ¼ï¼Œè¦æ±‚ï¼š1. è¯­è¨€æ´»æ³¼æœ‰è¶£ 2. ä½¿ç”¨emojiè¡¨æƒ… 3. å¢åŠ äº’åŠ¨æ€§ 4. ä¿æŒåŸæ„'
        
        try:
            response = Generation.call(
                model='qwen-turbo',
                messages=[
                    {'role': 'system', 'content': system_prompt},
                    {'role': 'user', 'content': original_text},
                ],
                temperature=0.7,
                max_tokens=2000,
            )
            
            if response.status_code == 200:
                return response.output.choices[0].message.content
            else:
                raise Exception(f'APIè°ƒç”¨å¤±è´¥: {response.message}')
        except Exception as e:
            print(f'æ–‡æ¡ˆæ”¹å†™å¤±è´¥: {e}')
            raise Exception('æ–‡æ¡ˆæ”¹å†™å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
    
    def generate_image(self, prompt: str) -> str:
        """AIç”Ÿå›¾"""
        try:
            response = ImageSynthesis.call(
                model='wanx-v1',
                prompt=prompt,
                n=1,
                size='1024*1024',
            )
            
            if response.status_code == 200:
                return response.output.results[0].url
            else:
                raise Exception(f'APIè°ƒç”¨å¤±è´¥: {response.message}')
        except Exception as e:
            print(f'AIç”Ÿå›¾å¤±è´¥: {e}')
            raise Exception('AIç”Ÿå›¾å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
```

### 5.4 APIæ§åˆ¶å™¨

```typescript
// backend/src/controllers/aiController.ts
import { Request, Response } from 'express';
import { AIService } from '../services/aiService';

const aiService = new AIService();

export const rewriteText = async (req: Request, res: Response) => {
  try {
    const { originalText, prompt } = req.body;
    
    if (!originalText) {
      return res.status(400).json({ error: 'åŸå§‹æ–‡æ¡ˆä¸èƒ½ä¸ºç©º' });
    }

    const rewrittenText = await aiService.rewriteText(originalText, prompt);
    
    res.json({ 
      success: true, 
      result: rewrittenText 
    });
  } catch (error: any) {
    res.status(500).json({ 
      error: error.message || 'æ–‡æ¡ˆæ”¹å†™å¤±è´¥' 
    });
  }
};

export const generateImage = async (req: Request, res: Response) => {
  try {
    const { prompt } = req.body;
    
    if (!prompt) {
      return res.status(400).json({ error: 'æç¤ºè¯ä¸èƒ½ä¸ºç©º' });
    }

    const imageUrl = await aiService.generateImage(prompt);
    
    res.json({ 
      success: true, 
      imageUrl 
    });
  } catch (error: any) {
    res.status(500).json({ 
      error: error.message || 'AIç”Ÿå›¾å¤±è´¥' 
    });
  }
};
```

---

## å…­ã€æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆ

### 6.1 ç¯å¢ƒè¦æ±‚

- **Node.js**: 18+ æˆ– **Python**: 3.11+
- **npm** æˆ– **yarn** æˆ– **pnpm**
- **Git**

### 6.2 å¿«é€Ÿå¯åŠ¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

#### æ­¥éª¤1ï¼šå…‹éš†é¡¹ç›®
```bash
git clone <é¡¹ç›®åœ°å€>
cd å†…å®¹ä¸­å°
```

#### æ­¥éª¤2ï¼šå®‰è£…ä¾èµ–

**å‰ç«¯**
```bash
cd frontend
npm install
```

**åç«¯**
```bash
cd backend
npm install  # æˆ– pip install -r requirements.txt
```

#### æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `backend/.env`:
```env
# æ•°æ®åº“é…ç½®
DATABASE_URL="file:./dev.db"  # SQLite

# é€šä¹‰åƒé—®APIé…ç½®
DASHSCOPE_API_KEY="your-api-key-here"

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# JWTå¯†é’¥ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
JWT_SECRET="your-jwt-secret"
```

#### æ­¥éª¤4ï¼šåˆå§‹åŒ–æ•°æ®åº“

**å¦‚æœä½¿ç”¨Prisma**
```bash
cd backend
npx prisma migrate dev
npx prisma generate
```

**å¦‚æœä½¿ç”¨SQLAlchemy**
```bash
cd backend
python init_db.py
```

#### æ­¥éª¤5ï¼šå¯åŠ¨æœåŠ¡

**å¯åŠ¨åç«¯**
```bash
cd backend
npm run dev  # æˆ– python -m uvicorn main:app --reload
```

**å¯åŠ¨å‰ç«¯**
```bash
cd frontend
npm run dev
```

è®¿é—®ï¼š`http://localhost:5173`ï¼ˆViteé»˜è®¤ç«¯å£ï¼‰

### 6.3 Dockeréƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

åˆ›å»º `docker-compose.yml`:

```yaml
version: '3.8'

services:
  frontend:
    build: ./frontend
    ports:
      - "5173:5173"
    volumes:
      - ./frontend:/app
    environment:
      - VITE_API_URL=http://localhost:3000

  backend:
    build: ./backend
    ports:
      - "3000:3000"
    volumes:
      - ./backend:/app
      - ./backend/uploads:/app/uploads
    environment:
      - DATABASE_URL=file:./dev.db
      - DASHSCOPE_API_KEY=${DASHSCOPE_API_KEY}
    depends_on:
      - db

  db:
    image: postgres:15
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      - POSTGRES_DB=content_platform
      - POSTGRES_USER=admin
      - POSTGRES_PASSWORD=password

volumes:
  postgres_data:
```

å¯åŠ¨ï¼š
```bash
docker-compose up -d
```

---

## ä¸ƒã€å¼€å‘å»ºè®®

### 7.1 å‰ç«¯å¼€å‘

1. **ç”»å¸ƒç¼–è¾‘**ï¼šä½¿ç”¨Fabric.jsï¼Œå°è£…è‡ªå®šä¹‰ç»„ä»¶
2. **çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨Zustandç®¡ç†ç¼–è¾‘å™¨çŠ¶æ€
3. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - ç”»å¸ƒæ•°æ®ä½¿ç”¨é˜²æŠ–ä¿å­˜
   - å›¾ç‰‡æ‡’åŠ è½½
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿åˆ—è¡¨ï¼‰

### 7.2 åç«¯å¼€å‘

1. **APIè®¾è®¡**ï¼šéµå¾ªRESTfulè§„èŒƒ
2. **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
3. **æ–‡ä»¶ä¸Šä¼ **ï¼šä½¿ç”¨multerï¼ˆNode.jsï¼‰æˆ–FastAPI UploadFile
4. **æ•°æ®éªŒè¯**ï¼šä½¿ç”¨Joiï¼ˆNode.jsï¼‰æˆ–Pydanticï¼ˆPythonï¼‰

### 7.3 AIé›†æˆ

1. **é”™è¯¯å¤„ç†**ï¼šAPIè°ƒç”¨å¤±è´¥æ—¶å‹å¥½æç¤º
2. **é™æµ**ï¼šé¿å…é¢‘ç¹è°ƒç”¨API
3. **ç¼“å­˜**ï¼šç›¸åŒè¯·æ±‚ç»“æœå¯ç¼“å­˜
4. **å¼‚æ­¥å¤„ç†**ï¼šAIç”Ÿå›¾ç­‰è€—æ—¶æ“ä½œä½¿ç”¨é˜Ÿåˆ—

---

## å…«ã€é¡¹ç›®å¯åŠ¨æ¸…å•

- [ ] å®‰è£…Node.js/Pythonç¯å¢ƒ
- [ ] å…‹éš†é¡¹ç›®ä»£ç 
- [ ] å®‰è£…å‰åç«¯ä¾èµ–
- [ ] é…ç½®ç¯å¢ƒå˜é‡ï¼ˆç‰¹åˆ«æ˜¯DASHSCOPE_API_KEYï¼‰
- [ ] åˆå§‹åŒ–æ•°æ®åº“
- [ ] å¯åŠ¨åç«¯æœåŠ¡
- [ ] å¯åŠ¨å‰ç«¯æœåŠ¡
- [ ] æµ‹è¯•é€šä¹‰åƒé—®APIè¿æ¥
- [ ] æµ‹è¯•åŸºæœ¬åŠŸèƒ½ï¼ˆåˆ›å»ºä½œå“ã€ä¿å­˜ã€å¯¼å‡ºï¼‰

---

## ä¹ã€æŠ€æœ¯æ ˆå¯¹æ¯”

| æŠ€æœ¯ | Node.jsæ–¹æ¡ˆ | Pythonæ–¹æ¡ˆ |
|------|------------|-----------|
| **å­¦ä¹ æ›²çº¿** | ä¸­ç­‰ | ä¸­ç­‰ |
| **æ€§èƒ½** | ä¼˜ç§€ | ä¼˜ç§€ï¼ˆFastAPIå¼‚æ­¥ï¼‰ |
| **ç”Ÿæ€** | éå¸¸ä¸°å¯Œ | ä¸°å¯Œ |
| **AIé›†æˆ** | ç®€å• | ç®€å• |
| **å¼€å‘é€Ÿåº¦** | å¿« | å¿« |
| **æ¨èåœºæ™¯** | å…¨æ ˆJavaScript | éœ€è¦å¤æ‚æ•°æ®å¤„ç† |

**æ¨è**ï¼šNode.jsæ–¹æ¡ˆï¼ˆå‰åç«¯ç»Ÿä¸€æŠ€æœ¯æ ˆï¼Œå¼€å‘æ•ˆç‡é«˜ï¼‰

---

## åã€åç»­ä¼˜åŒ–æ–¹å‘

1. **æ€§èƒ½ä¼˜åŒ–**
   - ç”»å¸ƒæ•°æ®å‹ç¼©å­˜å‚¨
   - å›¾ç‰‡CDNåŠ é€Ÿ
   - æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰

2. **åŠŸèƒ½æ‰©å±•**
   - å¤šäººåä½œç¼–è¾‘
   - ç‰ˆæœ¬æ§åˆ¶
   - å®æ—¶é¢„è§ˆ

3. **éƒ¨ç½²ä¼˜åŒ–**
   - CI/CDè‡ªåŠ¨åŒ–éƒ¨ç½²
   - å®¹å™¨åŒ–éƒ¨ç½²
   - è´Ÿè½½å‡è¡¡

---

## åä¸€ã€è·å–é€šä¹‰åƒé—®API Key

1. è®¿é—® [é˜¿é‡Œäº‘DashScopeæ§åˆ¶å°](https://dashscope.console.aliyun.com/)
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. åˆ›å»ºAPI Key
4. å°†API Keyé…ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­

**æ³¨æ„**ï¼šé€šä¹‰åƒé—®APIæŒ‰è°ƒç”¨æ¬¡æ•°è®¡è´¹ï¼Œæ³¨æ„æ§åˆ¶è°ƒç”¨é¢‘ç‡ã€‚

---

## åäºŒã€é¡¹ç›®åˆå§‹åŒ–è„šæœ¬

å¯ä»¥åˆ›å»ºä¸€ä¸ª `setup.sh` æˆ– `setup.bat` è„šæœ¬ï¼š

```bash
#!/bin/bash
# setup.sh

echo "ğŸš€ å¼€å§‹åˆå§‹åŒ–é¡¹ç›®..."

# å®‰è£…å‰ç«¯ä¾èµ–
echo "ğŸ“¦ å®‰è£…å‰ç«¯ä¾èµ–..."
cd frontend && npm install && cd ..

# å®‰è£…åç«¯ä¾èµ–
echo "ğŸ“¦ å®‰è£…åç«¯ä¾èµ–..."
cd backend && npm install && cd ..

# å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
echo "âš™ï¸ é…ç½®ç¯å¢ƒå˜é‡..."
cp backend/.env.example backend/.env

# åˆå§‹åŒ–æ•°æ®åº“
echo "ğŸ—„ï¸ åˆå§‹åŒ–æ•°æ®åº“..."
cd backend && npx prisma migrate dev && cd ..

echo "âœ… é¡¹ç›®åˆå§‹åŒ–å®Œæˆï¼"
echo "ğŸ“ è¯·ç¼–è¾‘ backend/.env æ–‡ä»¶ï¼Œé…ç½® DASHSCOPE_API_KEY"
echo "ğŸš€ è¿è¡Œ npm run dev å¯åŠ¨é¡¹ç›®"
```

---

## æ€»ç»“

æœ¬æŠ€æœ¯æ¶æ„æ–¹æ¡ˆæä¾›äº†ï¼š

1. âœ… **å®Œæ•´çš„æŠ€æœ¯é€‰å‹**ï¼šå‰åç«¯æŠ€æœ¯æ ˆ
2. âœ… **æ¸…æ™°çš„é¡¹ç›®ç»“æ„**ï¼šä¾¿äºå¼€å‘å’Œç»´æŠ¤
3. âœ… **æ•°æ®åº“è®¾è®¡**ï¼šæ ¸å¿ƒè¡¨ç»“æ„
4. âœ… **APIè®¾è®¡**ï¼šRESTful APIè§„èŒƒ
5. âœ… **é€šä¹‰åƒé—®é›†æˆ**ï¼šå®Œæ•´çš„AIåŠŸèƒ½å®ç°
6. âœ… **æœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆ**ï¼šå¿«é€Ÿå¯åŠ¨æŒ‡å—
7. âœ… **Dockeræ”¯æŒ**ï¼šå®¹å™¨åŒ–éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

**æ¨èæŠ€æœ¯æ ˆ**ï¼š
- å‰ç«¯ï¼šReact + TypeScript + Vite + Fabric.js + Tailwind CSS
- åç«¯ï¼šNode.js + Express + TypeScript + Prisma + SQLite
- AIï¼šé€šä¹‰åƒé—® DashScope SDK

è¿™ä¸ªæ–¹æ¡ˆå¯ä»¥è®©ä½ åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šå¿«é€Ÿå¯åŠ¨å’Œå¼€å‘é¡¹ç›®ï¼

